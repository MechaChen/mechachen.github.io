---
sidebar_position: 1.5
sidebar_label: '[Chat App] Architecture - High Level Design'
title: '[Chat App] Architecture - High Level Design'
tags:
  - Chat App
  - Architecture
---

<br />

Here are the infrastructure components and their relationships and responsibilities:

<img src="/img/chat_app_infrastructure.jpg" alt="Chat App Infrastructure" />

### Infrastructure components

‚öôÔ∏è Compute & Routing
- **HTTP Load Balancer**ÔºöDistributes REST API traffic evenly across HTTP servers to ensure scalability and high availability.
- **WebSocket Load Balancer**ÔºöBalances long-lived WebSocket connections, helping the system handle many concurrent users reliably.
- **EC2 Instances (HTTP)**ÔºöHandle stateless API operations like user creation and message history retrieval, allowing horizontal scaling.
- **EC2 Instances (WebSocket)**ÔºöMaintain persistent connections for real-time features like sending/receiving messages, ensuring low-latency interaction.

ü´ô Data Storage
- **DynamoDB**ÔºöProvides **fast read-write**, **scalable** storage for various chat-related data: users, rooms, messages, and user-room relationships‚Äîall with flexible schema support and high throughput.

‚ö°Ô∏è Real-time Communication
- **Redis**ÔºöStores WebSocket connection IDs and enables cross-server message broadcasting between WebSocket EC2 instances.

<br />

### Component responsibilities

1. **HTTP `GET /users` endpoint**Ôºö <br /> Client sends a request to retrieve all user data. The backend queries **User DynamoDB** and returns the result.

2. **HTTP `POST /users` endpoint**Ôºö <br /> Client creates a new user. The backend processes the data and writes it to **User DynamoDB**.

3. **HTTP `GET /rooms/{room_id}/messages` endpoint**Ôºö<br /> Client requests the message history of a chat room. The backend fetches the messages from **messages DynamoDB** and returns them.

4. **WebSocket `create_room` action**Ôºö<br /> Client sends a command to create a chat room via WebSocket. The backend stores the user-to-room relation in **user\_rooms DynamoDB**.

5. **WebSocket `create_room` (continued)**Ôºö<br /> The system also creates the room metadata and stores it in **rooms DynamoDB**.

6. **WebSocket `create_message` action**Ôºö<br /> Client sends a new message via WebSocket. The backend stores it in **messages DynamoDB**.

7. **Redis Broadcast**Ôºö<br /> The system uses **Redis** to store WebSocket connection IDs and serve as a broadcast intermediary. This allows different WS EC2 nodes to be aware of existing connections, enabling real-time message forwarding to users, even if they are connected to different servers.

<br /><br />